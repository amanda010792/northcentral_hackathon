{"topologyName":"AlarmFatigueRefApp","config":"{\"topology.workers\":5,\"topology.acker.executors\":1,\"topology.message.timeout.secs\":127,\"clustersSecurityConfig\":[{}],\"topology.worker.childopts\":\"-Xmx2048m\"}","sources":[{"id":15,"topologyId":3,"topologyComponentBundleId":1,"versionId":5,"name":"ReceiveDeviceEvents","description":"","config":{"properties":{"cluster":"1","consumerGroupId":"af_kafka_1","retryDelayPeriodMs":2,"maximumUncommittedOffsets":10000000,"maxRecordsPerPoll":"500","maximumRetries":2147483647,"parallelism":1,"emitNullTuples":false,"partitionRefreshPeriodMs":2000,"securityProtocol":"PLAINTEXT","bootstrapServers":"{{HOST1}}:6667","kafkaServiceName":"","retryDelayMaximumMs":10000,"fetchMaximumBytesPerPartition":"1048576","firstPollOffsetStrategy":"UNCOMMITTED_EARLIEST","sslTruststoreType":"JKS","clusters":"{{CLUSTERNAME}}","fetchMinimumBytes":"1","consumerStartupDelayMs":60000,"sslKeystoreType":"JKS","sslTrustManagerAlgo":"PKIX","retryInitialDelayMs":0,"sslKeyManagerAlgo":"SunX509","sslProtocol":"TLS","topic":"afeventavro","pollTimeoutMs":200,"offsetCommitPeriodMs":30000}},"outputStreams":[{"id":11,"versionId":5,"streamId":"kafka_stream_1","description":null,"topologyId":3,"fields":[{"name":"DeviceGUID","type":"STRING","optional":false},{"name":"DeviceId","type":"STRING","optional":true},{"name":"PatientId","type":"INTEGER","optional":true},{"name":"PatientName","type":"STRING","optional":true},{"name":"DiagnosisDescription","type":"STRING","optional":true},{"name":"HealthProviderName","type":"STRING","optional":true},{"name":"PatLocation","type":"STRING","optional":true},{"name":"DoctorEmail","type":"STRING","optional":true},{"name":"SampleDuration","type":"INTEGER","optional":true},{"name":"Respiration","type":"INTEGER","optional":true},{"name":"PulseRate","type":"INTEGER","optional":true},{"name":"BloodPressureSystolic","type":"INTEGER","optional":true},{"name":"BloodPressureDiastolic","type":"INTEGER","optional":true},{"name":"BodyTemperature","type":"FLOAT","optional":true},{"name":"TransmissionTimestamp","type":"STRING","optional":true}],"timestamp":1508789711639}],"timestamp":1508780001849}],"sinks":[{"id":18,"topologyId":3,"topologyComponentBundleId":10,"versionId":5,"name":"StoreDeviceEventsInHDFS","description":"","config":{"properties":{"fsUrl":"hdfs://{{HOST1}}:8020","outputFields":["DeviceGUID","DeviceId","PatientId","PatientName","DiagnosisDescription","HealthProviderName","PatLocation","DoctorEmail","SampleDuration","Respiration","PulseRate","BloodPressureSystolic","BloodPressureDiastolic","BodyTemperature","TransmissionTimestamp"],"cluster":"1","path":"/tmp/af","extension":".txt","rotationPolicy":{"sizeBasedRotation":{"rotationSize":100,"rotationSizeUnit":"MB"}},"prefix":"","parallelism":1,"topic":"","countPolicyValue":1,"clusters":"{{CLUSTERNAME}}"}},"timestamp":1508789711639},{"id":19,"topologyId":3,"topologyComponentBundleId":16,"versionId":5,"name":"AlertEvent","description":"","config":{"properties":{"cluster":"2","clusterReplication":1,"segmentGranularity":"FIVE_MINUTE","indexRetryPeriod":"PT10M","maxBatchSize":2000,"maxPendingBatches":5,"discoveryPath":"/druid/discovery","clusterPartitions":1,"windowPeriod":"PT10M","aggregatorList":[{"count":{"name":"count"}},{"doublemax":{"name":"PulseRate_AVG","fieldName":"PulseRate_AVG"}},{"doublemax":{"name":"Respiration_AVG","fieldName":"Respiration_AVG"}},{"doublemax":{"name":"BloodPressureSystolic_AVG","fieldName":"BloodPressureSystolic_AVG"}},{"doublemax":{"name":"BloodPressureDiastolic_AVG","fieldName":"BloodPressureDiastolic_AVG"}},{"doublemax":{"fieldName":"BodyTemperature_AVG","name":"BodyTemperature_AVG"}}],"tranquilityZKconnect":"{{HOST1}}:2181","discardStreamId":"DRUID-DISCARD-STREAM-ID","indexService":"druid/overlord","blockOnFull":true,"timestampField":"processingTime","lingerMillis":0,"queryGranularity":"MINUTE","dataSource":"device-event-alerts-cube","clusters":"{{CLUSTERNAME}}","dimensions":["DoctorEmail","DeviceGUID","HealthProviderName","PatientName","PatLocation","DeviceId"]}},"timestamp":1508789711639},{"id":20,"topologyId":3,"topologyComponentBundleId":12,"versionId":5,"name":"NotifyDoctor","description":"","config":{"properties":{"notifierName":"Email Notifier","parallelism":1,"className":"com.hortonworks.streamline.streams.notifiers.EmailNotifier","fieldValues":{"contentType":"text/plain","from":"hwx.nc.demo@gmail.com","to":"${DoctorEmail}","subject":"${PatientName} abnormal Pulse Rate of ${PulseRate_AVG}","body":"${HealthProviderName},\n\nPatient ${PatientName} in location ${PatLocation} has an abnormal Pulse Rate of ${PulseRate_AVG}. \n\nDiagnosis: ${DiagnosisDescription}\n\nOther Patient Stats:\nTemperature: ${BodyTemperature_AVG}\nRespiration: ${Respiration_AVG}\nBlood Pressure: ${BloodPressureSystolic_AVG} / ${BloodPressureDiastolic_AVG}\n"},"notificationStoreClassName":"","jarFileName":"notifiers-b69a2936-d072-4d1d-9832-8f4985c6cc23.jar","properties":{"ssl":false,"starttls":true,"debug":false,"protocol":"smtp","auth":true,"username":"hwx.nc.demo@gmail.com","password":"Hwx1234.","host":"smtp.gmail.com","port":587}}},"timestamp":1508789711639},{"id":21,"topologyId":3,"topologyComponentBundleId":16,"versionId":5,"name":"AllDeviceEventCube","description":"","config":{"properties":{"cluster":"2","clusterReplication":1,"segmentGranularity":"FIVE_MINUTE","indexRetryPeriod":"PT10M","maxBatchSize":2000,"maxPendingBatches":5,"discoveryPath":"/druid/discovery","clusterPartitions":1,"windowPeriod":"PT10M","aggregatorList":[{"count":{"name":"count"}},{"doublemax":{"fieldName":"PulseRate_AVG","name":"PulseRate_AVG"}},{"doublemax":{"fieldName":"Respiration_AVG","name":"Respiration_AVG"}},{"doublemax":{"fieldName":"BloodPressureSystolic_AVG","name":"BloodPressureSystolic_AVG"}},{"doublemax":{"fieldName":"BloodPressureDiastolic_AVG","name":"BloodPressureDiastolic_AVG"}},{"doublemax":{"fieldName":"BodyTemperature_AVG","name":"BodyTemperature_AVG"}}],"tranquilityZKconnect":"{{HOST1}}:2181","discardStreamId":"DRUID-DISCARD-STREAM-ID","indexService":"druid/overlord","blockOnFull":true,"timestampField":"processingTime","lingerMillis":0,"queryGranularity":"MINUTE","dataSource":"alarm-fatigue-all-events-cube","clusters":"{{CLUSTERNAME}}","dimensions":["DeviceGUID","HealthProviderName","DoctorEmail","PatientName","PatLocation","DeviceId"]}},"timestamp":1508789711639}],"processors":[{"id":16,"topologyId":3,"topologyComponentBundleId":5,"versionId":5,"name":"CheckPatientStatsOverTime","description":"","config":{"properties":{"rules":[3],"parallelism":1}},"outputStreams":[{"id":12,"versionId":5,"streamId":"window_transform_stream_4","description":null,"topologyId":3,"fields":[{"name":"DeviceGUID","type":"STRING","optional":false},{"name":"DoctorEmail","type":"STRING","optional":false},{"name":"HealthProviderName","type":"STRING","optional":false},{"name":"DeviceId","type":"STRING","optional":false},{"name":"PatientName","type":"STRING","optional":false},{"name":"DiagnosisDescription","type":"STRING","optional":false},{"name":"PatLocation","type":"STRING","optional":false},{"name":"PulseRate_AVG","type":"DOUBLE","optional":false},{"name":"Respiration_AVG","type":"DOUBLE","optional":false},{"name":"BloodPressureSystolic_AVG","type":"DOUBLE","optional":false},{"name":"BloodPressureDiastolic_AVG","type":"DOUBLE","optional":false},{"name":"BodyTemperature_AVG","type":"DOUBLE","optional":false}],"timestamp":1508789711639},{"id":13,"versionId":5,"streamId":"window_notifier_stream_4","description":null,"topologyId":3,"fields":[{"name":"DeviceGUID","type":"STRING","optional":false},{"name":"DoctorEmail","type":"STRING","optional":false},{"name":"HealthProviderName","type":"STRING","optional":false},{"name":"DeviceId","type":"STRING","optional":false},{"name":"PatientName","type":"STRING","optional":false},{"name":"DiagnosisDescription","type":"STRING","optional":false},{"name":"PatLocation","type":"STRING","optional":false},{"name":"PulseRate_AVG","type":"DOUBLE","optional":false},{"name":"Respiration_AVG","type":"DOUBLE","optional":false},{"name":"BloodPressureSystolic_AVG","type":"DOUBLE","optional":false},{"name":"BloodPressureDiastolic_AVG","type":"DOUBLE","optional":false},{"name":"BodyTemperature_AVG","type":"DOUBLE","optional":false}],"timestamp":1508789711639}],"timestamp":1508789711639},{"id":17,"topologyId":3,"topologyComponentBundleId":4,"versionId":5,"name":"CheckPulseRate_RULE","description":"","config":{"properties":{"outputStreams":[{"id":"rule_transform_stream_1","schema":{"fields":[{"name":"DeviceGUID","type":"STRING","optional":false},{"name":"DoctorEmail","type":"STRING","optional":false},{"name":"HealthProviderName","type":"STRING","optional":false},{"name":"DeviceId","type":"STRING","optional":false},{"name":"PatientName","type":"STRING","optional":false},{"name":"DiagnosisDescription","type":"STRING","optional":false},{"name":"PatLocation","type":"STRING","optional":false},{"name":"PulseRate_AVG","type":"DOUBLE","optional":false},{"name":"Respiration_AVG","type":"DOUBLE","optional":false},{"name":"BloodPressureSystolic_AVG","type":"DOUBLE","optional":false},{"name":"BloodPressureDiastolic_AVG","type":"DOUBLE","optional":false},{"name":"BodyTemperature_AVG","type":"DOUBLE","optional":false}]}},{"id":"rule_notifier_stream_1","schema":{"fields":[{"name":"DeviceGUID","type":"STRING","optional":false},{"name":"DoctorEmail","type":"STRING","optional":false},{"name":"HealthProviderName","type":"STRING","optional":false},{"name":"DeviceId","type":"STRING","optional":false},{"name":"PatientName","type":"STRING","optional":false},{"name":"DiagnosisDescription","type":"STRING","optional":false},{"name":"PatLocation","type":"STRING","optional":false},{"name":"PulseRate_AVG","type":"DOUBLE","optional":false},{"name":"Respiration_AVG","type":"DOUBLE","optional":false},{"name":"BloodPressureSystolic_AVG","type":"DOUBLE","optional":false},{"name":"BloodPressureDiastolic_AVG","type":"DOUBLE","optional":false},{"name":"BodyTemperature_AVG","type":"DOUBLE","optional":false}]}}],"rules":[3]}},"outputStreams":[{"id":14,"versionId":5,"streamId":"rule_transform_stream_1","description":null,"topologyId":3,"fields":[{"name":"DeviceGUID","type":"STRING","optional":false},{"name":"DoctorEmail","type":"STRING","optional":false},{"name":"HealthProviderName","type":"STRING","optional":false},{"name":"DeviceId","type":"STRING","optional":false},{"name":"PatientName","type":"STRING","optional":false},{"name":"DiagnosisDescription","type":"STRING","optional":false},{"name":"PatLocation","type":"STRING","optional":false},{"name":"PulseRate_AVG","type":"DOUBLE","optional":false},{"name":"Respiration_AVG","type":"DOUBLE","optional":false},{"name":"BloodPressureSystolic_AVG","type":"DOUBLE","optional":false},{"name":"BloodPressureDiastolic_AVG","type":"DOUBLE","optional":false},{"name":"BodyTemperature_AVG","type":"DOUBLE","optional":false}],"timestamp":1508789711639},{"id":15,"versionId":5,"streamId":"rule_notifier_stream_1","description":null,"topologyId":3,"fields":[{"name":"DeviceGUID","type":"STRING","optional":false},{"name":"DoctorEmail","type":"STRING","optional":false},{"name":"HealthProviderName","type":"STRING","optional":false},{"name":"DeviceId","type":"STRING","optional":false},{"name":"PatientName","type":"STRING","optional":false},{"name":"DiagnosisDescription","type":"STRING","optional":false},{"name":"PatLocation","type":"STRING","optional":false},{"name":"PulseRate_AVG","type":"DOUBLE","optional":false},{"name":"Respiration_AVG","type":"DOUBLE","optional":false},{"name":"BloodPressureSystolic_AVG","type":"DOUBLE","optional":false},{"name":"BloodPressureDiastolic_AVG","type":"DOUBLE","optional":false},{"name":"BodyTemperature_AVG","type":"DOUBLE","optional":false}],"timestamp":1508789711639}],"timestamp":1508789711639}],"edges":[{"id":13,"versionId":5,"topologyId":3,"fromId":15,"toId":16,"streamGroupings":[{"streamId":11,"grouping":"FIELDS","fields":["DeviceGUID","DoctorEmail","HealthProviderName","DeviceId","PatientName","DiagnosisDescription","PatLocation"]}],"timestamp":1508789711639},{"id":14,"versionId":5,"topologyId":3,"fromId":15,"toId":18,"streamGroupings":[{"streamId":11,"grouping":"SHUFFLE","fields":null}],"timestamp":1508789711639},{"id":15,"versionId":5,"topologyId":3,"fromId":16,"toId":21,"streamGroupings":[{"streamId":12,"grouping":"SHUFFLE","fields":null}],"timestamp":1508789711639},{"id":16,"versionId":5,"topologyId":3,"fromId":16,"toId":17,"streamGroupings":[{"streamId":12,"grouping":"SHUFFLE","fields":null}],"timestamp":1508789711639},{"id":17,"versionId":5,"topologyId":3,"fromId":17,"toId":20,"streamGroupings":[{"streamId":15,"grouping":"SHUFFLE","fields":null}],"timestamp":1508789711639},{"id":18,"versionId":5,"topologyId":3,"fromId":17,"toId":19,"streamGroupings":[{"streamId":14,"grouping":"SHUFFLE","fields":null}],"timestamp":1508789711639}],"rules":[{"id":3,"versionId":5,"topologyId":3,"name":"PulseRateOutOfRange","description":"Pulse Rates out of norm, for Pulse Rates > 100 or < 40","streams":["window_transform_stream_4"],"condition":"PulseRate_AVG > 100 OR PulseRate_AVG < 40","sql":"SELECT *  FROM window_transform_stream_4 WHERE PulseRate_AVG > 100 OR PulseRate_AVG < 40","actions":[{"__type":"com.hortonworks.streamline.streams.layout.component.rule.action.NotifierAction","name":"notifierAction","outputStreams":["rule_notifier_stream_1"],"notifierName":"Email Notifier","outputFieldsAndDefaults":{"from":"hwx.nc.demo@gmail.com","to":"${DoctorEmail}","body":"${HealthProviderName},\n\nPatient ${PatientName} in location ${PatLocation} has an abnormal Pulse Rate of ${PulseRate_AVG}. \n\nDiagnosis: ${DiagnosisDescription}\n\nOther Patient Stats:\nTemperature: ${BodyTemperature_AVG}\nRespiration: ${Respiration_AVG}\nBlood Pressure: ${BloodPressureSystolic_AVG} / ${BloodPressureDiastolic_AVG}\n","contentType":"text/plain","subject":"${PatientName} abnormal Pulse Rate of ${PulseRate_AVG}"}},{"__type":"com.hortonworks.streamline.streams.layout.component.rule.action.TransformAction","name":"transformAction","outputStreams":["rule_transform_stream_1"],"transforms":[]}],"outputStreams":["rule_transform_stream_1","rule_notifier_stream_1"],"timestamp":1508789711639}],"windows":[{"id":3,"versionId":5,"topologyId":3,"name":"window_auto_generated","description":"window description auto generated","streams":["kafka_stream_1"],"window":{"windowLength":{"class":".Window$Duration","durationMs":60000},"slidingInterval":{"class":".Window$Duration","durationMs":60000},"tsField":null,"lagMs":0},"actions":[{"__type":"com.hortonworks.streamline.streams.layout.component.rule.action.TransformAction","name":"transformAction","outputStreams":["window_transform_stream_4"],"transforms":[]}],"projections":[{"functionName":"MEAN","args":["PulseRate"],"outputFieldName":"PulseRate_AVG"},{"functionName":"MEAN","args":["Respiration"],"outputFieldName":"Respiration_AVG"},{"functionName":"MEAN","args":["BloodPressureSystolic"],"outputFieldName":"BloodPressureSystolic_AVG"},{"functionName":"MEAN","args":["BloodPressureDiastolic"],"outputFieldName":"BloodPressureDiastolic_AVG"},{"functionName":"MEAN","args":["BodyTemperature"],"outputFieldName":"BodyTemperature_AVG"},{"expr":"DeviceGUID"},{"expr":"DoctorEmail"},{"expr":"HealthProviderName"},{"expr":"DeviceId"},{"expr":"PatientName"},{"expr":"DiagnosisDescription"},{"expr":"PatLocation"}],"groupbykeys":["DeviceGUID","DoctorEmail","HealthProviderName","DeviceId","PatientName","DiagnosisDescription","PatLocation"],"outputStreams":["window_transform_stream_9","window_notifier_stream_9"],"timestamp":1508789711639}],"branchRules":[],"bundleIdToType":{"1":"KAFKA","12":"NOTIFICATION","4":"RULE","5":"WINDOW","16":"DRUID","10":"HDFS"},"topologyEditorMetadata":{"topologyId":3,"versionId":5,"data":"{\"sources\":[{\"x\":127.5,\"y\":176.25,\"id\":15}],\"sinks\":[{\"x\":989.748779296875,\"y\":210.77145385742188,\"id\":21},{\"x\":1310.5357666015625,\"y\":517.5000610351562,\"id\":20},{\"x\":438.91534423828125,\"y\":720.7076416015625,\"id\":18},{\"x\":1316.8409423828125,\"y\":621.5697021484375,\"id\":19}],\"processors\":[{\"x\":991.02685546875,\"y\":576.2896728515625,\"id\":17},{\"x\":449.1396484375,\"y\":256.7807312011719,\"id\":16}],\"graphTransforms\":{\"dragCoords\":[-301.48629549158363,-96.32915256775601],\"zoomScale\":1.024227105273991},\"customNames\":null}","timestamp":1508789711639}}